# sham-ui-ssr

[![Build Status](https://travis-ci.com/sham-ui/sham-ui-ssr.svg?branch=master)](https://travis-ci.com/sham-ui/sham-ui-ssr)
[![npm version](https://badge.fury.io/js/sham-ui-ssr.svg)](https://badge.fury.io/js/sham-ui-ssr)
[![MIT Licence](https://badges.frapsoft.com/os/mit/mit.svg?v=103)](https://opensource.org/licenses/mit-license.php)

Server side rendering for sham-ui

### Install

```bash
# npm
npm install --save-dev sham-ui-ssr
```

```bash
# yarn
yarn add -D sham-ui-ssr
```

### API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

##### Table of Contents

-   [setup](#setup)
    -   [Parameters](#parameters)
-   [setup](#setup-1)
    -   [Parameters](#parameters-1)
    -   [Examples](#examples)
-   [hydrate](#hydrate)
    -   [Parameters](#parameters-2)
    -   [Examples](#examples-1)
-   [hydrate](#hydrate-1)
    -   [Parameters](#parameters-3)
-   [makeRestore](#makerestore)
    -   [Parameters](#parameters-4)
-   [makeRestore](#makerestore-1)
    -   [Parameters](#parameters-5)
-   [Component](#component)
-   [SSRRenderResult](#ssrrenderresult)
    -   [Properties](#properties)
-   [SSRToJSON](#ssrtojson)
-   [SSRRenderResultSnapshot](#ssrrenderresultsnapshot)
    -   [Properties](#properties-1)
-   [ssr](#ssr)
    -   [Parameters](#parameters-6)
    -   [Examples](#examples-2)
-   [RenderResultSnapshot](#renderresultsnapshot)
    -   [Properties](#properties-2)
-   [RenderResult](#renderresult)
    -   [Properties](#properties-3)
-   [ToJSON](#tojson)
-   [ssrAndRehydrate](#ssrandrehydrate)
    -   [Parameters](#parameters-7)
    -   [Examples](#examples-3)

#### setup

Main function for setup hydrating components

##### Parameters

-   `DI` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** App DI container

#### setup

Main function for rehydrating

##### Parameters

-   `DI` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** App DI container
-   `storage` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** 

##### Examples

```javascript
import { createDI, start } from 'sham-ui';
import setupUnsafe from 'sham-ui-unsafe';
import { setupRehydrator } from 'sham-ui-ssr/rehydrator';

const DI = createDI();
const data = JSON.parse( document.getElementById( 'data' ).innerText );
const disableRehydrating = setupRehydrator( DI, data );
mainInitializer( DI, root );
start( DI );
disableRehydrating();
setupUnsafe( DI );
```

Returns **[Function](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function)** Restore function for disable rehydrating and switch to default behavior

#### hydrate

Hydrate all components

##### Parameters

-   `DI` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** App DI container

##### Examples

```javascript
import { createDI, start } from 'sham-ui';
import { setupHydrator, hydrate } from 'sham-ui-ssr/hydrator';

const DI = createDI();
const root = setupHydrator( DI );
mainInitializer( DI, root );
start( DI );
hydrate( DI ).then( storage => {
    const { html, data } = storage.hydrate();
} )
```

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

#### hydrate

Hydrate node

##### Parameters

-   `storage` **Storage** 
-   `i` **([Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)> | [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number))** 

Returns **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

#### makeRestore

Save hooks & dom services for restore after rehydrating

##### Parameters

-   `DI` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** App DI container

Returns **[Function](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function)** 

#### makeRestore

Make restore function for hooks & dom

##### Parameters

-   `DI` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** App DI container

Returns **[Function](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function)** 

#### Component

-   **See: <https://github.com/sham-ui/sham-ui#component>
    **

sham-ui component

#### SSRRenderResult

Result of server side renderer

Type: [Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)

##### Properties

-   `component` **[Component](#component)** Rendered component instance
-   `html` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Rendered html
-   `data` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Data for component rehydrating
-   `toJSON` **[SSRToJSON](#ssrtojson)** Dump to JSON for jest's snapshot testing

#### SSRToJSON

Function for dump server side render result (using for jest-snapshots)

Type: [Function](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function)

Returns **[SSRRenderResultSnapshot](#ssrrenderresultsnapshot)** 

#### SSRRenderResultSnapshot

Type: [Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)

##### Properties

-   `html` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Rendered html
-   `data` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Data for rehydrating

#### ssr

Server side render for component

##### Parameters

-   `componentClass` **Class&lt;[Component](#component)>** Component class for rendering
-   `componentOptions` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Options (optional, default `{}`)

##### Examples

```javascript
import Label from './Label.sht';
import { ssr } from 'sham-ui-ssr/testing';

it( 'renders correctly', () => {
    const meta = ssr( Label );

    expect( meta.component.ID ).toEqual( 'component' );
    expect( meta.toJSON() ).toMatchSnapshot();
} );
```

Returns **[SSRRenderResult](#ssrrenderresult)** 

#### RenderResultSnapshot

Type: [Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)

##### Properties

-   `html` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Rendered html
-   `Options` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Component options

#### RenderResult

Result of renderer

Type: [Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)

##### Properties

-   `DI` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** App DI container
-   `component` **[Component](#component)** Rendered component instance
-   `html` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** SSR html string
-   `data` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Data for rehydrating
-   `toJSON` **[ToJSON](#tojson)** Dump to JSON for jest's snapshot testing

#### ToJSON

Function for dump render result (using for jest-snapshots)

Type: [Function](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function)

Returns **[RenderResultSnapshot](#renderresultsnapshot)** 

#### ssrAndRehydrate

Render component with SSR & rehydrating

##### Parameters

-   `componentClass` **Class&lt;[Component](#component)>** Component class for rendering
-   `componentOptions` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Options (optional, default `{}`)

##### Examples

```javascript
import Label from './Label.sht';
import { ssrAndRehydrate } from 'sham-ui-ssr/testing';

it( 'renders correctly', () => {
    const meta = ssrAndRehydrate( Label );

    expect( meta.component.ID ).toEqual( 'component' );
    expect( meta.toJSON() ).toMatchSnapshot();
} );
```

Returns **[RenderResult](#renderresult)** 
